%%%%%%%%%%%%%%%%%%Стилевой файл для русскоязычных статей дальневосточного математического журнала на 2015 год.
\RequirePackage[cp1251]{inputenc}
\RequirePackage[english,russian]{babel}
\RequirePackage{amsmath,amssymb,amsthm,amsfonts}
\RequirePackage{graphicx}
%\RequirePackage{amsbib}


\expandafter\ifx\csname selectfont\endcsname\relax
% Для старой FSS:

\def\vraisup{\mathop{\rm vrai\,sup}\withlimits}
\def\rot{\mathop{\rm rot}\nolimits}
\def\grad{\mathop{\rm grad}\nolimits}
\def\div{\mathop{\rm div}\nolimits}
\def\rank{\mathop{\rm rank}\nolimits}
\def\tg{\mathop{\rm tg}\nolimits}
\def\ctg{\mathop{\rm ctg}\nolimits}
\def\cosec{\mathop{\rm cosec}\nolimits}
\def\arctg{\mathop{\rm arctg}\nolimits}
\def\arcctg{\mathop{\rm arcctg}\nolimits}
\def\sh{\mathop{\rm sh}\nolimits}
\def\ch{\mathop{\rm ch}\nolimits}
\def\th{\mathop{\rm th}\nolimits}
\def\cth{\mathop{\rm cth}\nolimits}
\else % для NFSS:

\def\sgn{\mathop{\operator@font sgn}\nolimits}

\def\rot{\mathop{\operator@font rot}\nolimits}
\def\grad {\mathop{\operator@font grad}\nolimits}
\def\div {\mathop{\operator@font div}\nolimits}
\def\rank {\mathop{\operator@font rank}\nolimits}
\def\tg {\mathop{\operator@font tg}\nolimits}
\def\ctg {\mathop{\operator@font ctg}\nolimits}
\def\cosec {\mathop{\operator@font cosec}\nolimits}
\def\arctg {\mathop{\operator@font arctg}\nolimits}
\def\arcctg {\mathop{\operator@font arcctg}\nolimits}
\def\sh {\mathop{\operator@font sh}\nolimits}
\def\ch {\mathop{\operator@font ch}\nolimits}
\def\th {\mathop{\operator@font th}\nolimits}
\def\cth {\mathop{\operator@font cth}\nolimits}
\fi
\let\eps\varepsilon
\let\vphi\varphi
% Определим основной стиль
%
\@ifundefined{chapter}{\def\@mainstyle{A}}{% это не статья
\@ifundefined{abstractname}{\def\@mainstyle{B}}% это не report
{\def\@mainstyle{R}}}
\newcount\@rpage
%
% Теперь подправим заголовки
%
\message{heading names,}
\def\contentsname{Оглавление}
\def\figurename{Рис.}
\def\partname{Часть}     % Надеюсь, это не займет слишком много
\def\chaptername{Глава}  % лишней памяти
\def\listfigurename{Список рисунков}
\def\listtablename{Список таблиц}
\def\refname{Список литературы}
\def\bibname{Список литературы}
\def\indexname{Предметный указатель}
\def\tablename{Таблица}
\def\abstractname{Аннотация}
%
% Теперь займемся секциями и главами.
% Пусть первый абзац после начала главы будет с отступом.
%
\message{headings,}
\def\chapter{\clearpage % Для экономии бумаги - вместо \cleardoublepage
   \thispagestyle{myheadings}%
   \global\@topnum\z@
   \@afterindenttrue % Здесь изменение (было \@afterindentfalse)
   \secdef\@chapter\@schapter}
%

%
\def\section{\@startsection {section}{1}{\z@}{3.5ex plus1ex minus
    .2ex}{2.3ex plus.2ex}{\reset@font\Large\bf}}
\def\subsection{\@startsection{subsection}{2}{\z@}{3.25ex plus1ex
    minus.2ex}{1.5ex plus.2ex}{\reset@font\large\bf}}
\def\subsubsection{\@startsection{subsubsection}{3}{\z@}{3.25ex plus
    1ex minus.2ex}{1.5ex plus.2ex}{\reset@font\normalsize\bf}}
%
%
\def\@aftersepkern{\kern-.5em}
\def\postchapter{.}
\def\postsection{.\@aftersepkern}
\def\postsubsection{.\@aftersepkern}
\def\postsubsubsection{.\@aftersepkern}
\def\postparagraph{.\@aftersepkern}
\def\postsubparagraph{.\@aftersepkern}
\def\presection{}
\def\presubsection{}
\def\presubsubsection{}
\def\preparagraph{}
\def\presubparagraph{}
%
%  Приступим к постановке точек после номеров...
%
\def\@sect#1#2#3#4#5#6[#7]#8{\ifnum #2>\c@secnumdepth
     \let\@svsec\@empty\else
     \refstepcounter{#1}\edef\@svsec{%
     \csname pre#1\endcsname % Добавил строку
     \csname the#1\endcsname
     \csname post#1\endcsname % Добавил строку
\hskip 1em}\fi
     \@tempskipa #5\relax
      \ifdim \@tempskipa>\z@
        \begingroup #6\relax
          \@hangfrom{\hskip #3\relax\@svsec
                   }{\interlinepenalty \@M \ignorespaces#8\par}%
% Вставил в предыдущей строке \ignorespaces
% Здесь и далее такие добавки - против лишних пробелов, появляющихся,
% если аргумент sectioning-команды начинается с пробела.
        \endgroup
       \csname #1mark\endcsname{\protect\ignorespaces #7}\addcontentsline
% Добавил два token'а перед #7
         {toc}{#1}{\ifnum #2>\c@secnumdepth \else
                      \protect\numberline{\csname the#1\endcsname
                     \csname post#1\endcsname % Добавил строку
}\fi
\protect\ignorespaces #7}\else
% Добавил два token'а перед #7
        \def\@svsechd{#6\hskip #3\relax  %% \relax added 2 May 90
                   \@svsec #8\csname #1mark\endcsname
                      {\protect\ignorespaces #7}\addcontentsline
% Добавил два token'а перед #7
                           {toc}{#1}{\ifnum #2>\c@secnumdepth \else
                             \protect\numberline{\csname the#1\endcsname
                          \csname post#1\endcsname % Добавил строку
}\fi
\protect\ignorespaces #7}}\fi
% Добавил два token'а перед #7
     \@xsect{#5}}
\def\@ssect#1#2#3#4#5{\@tempskipa #3\relax
   \ifdim \@tempskipa>\z@
     \begingroup #4\@hangfrom{\hskip #1}{\interlinepenalty \@M
\ignorespaces #5\par}\endgroup % добавил \ignorespaces перед #5
   \else \def\@svsechd{#4\hskip #1\relax
\ignorespaces #5}\fi % добавил \ignorespaces перед #5
    \@xsect{#3}}
% После номеров глав тоже пусть стоят точки:
%
\def\@makechapterhead#1{%
  \vspace*{50\p@}%
  {\parindent \z@\raggedright
    \ifnum \c@secnumdepth >\m@ne
     \huge\bf \@chapapp{} \thechapter\postchapter % добавлено \postchapter
    \par
    \vskip 20\p@ \fi
    \Huge \bf
    \ignorespaces #1\par % добавил \ignorespaces
    \nobreak
    \vskip 40\p@
  }}
\def\@makeschapterhead#1{%
  \vspace*{50\p@}%
  {\parindent \z@ \raggedright
    \Huge \bf
    \ignorespaces #1\par % добавил \ignorespaces
    \nobreak
    \vskip 40\p@
  }}
%
% Сделаем так, чтоб в оглавлении точки шли и после номеров глав...
%
\def\@chapter[#1]#2{\ifnum \c@secnumdepth >\m@ne
        \refstepcounter{chapter}%
        \typeout{\@chapapp\space\thechapter.}%
        \addcontentsline{toc}{chapter}{\protect
        \numberline{\thechapter
              \postchapter % Добавил строку
}%
\protect\ignorespaces #1}\else % Добавил два token'а перед #1
      \addcontentsline{toc}{chapter}{\protect\ignorespaces#1}\fi
% В предыдущей строчке вставлено два token'а перед #1
   \chaptermark{\protect\ignorespaces #1}%
   \addtocontents{lof}%
       {\protect\addvspace{10\p@}} % Adds between-chapter space
   \addtocontents{lot}%
       {\protect\addvspace{10\p@}} % to lists of figs & tables.
   \if@twocolumn                   % Tests for two-column mode.
           \@topnewpage[\@makechapterhead{#2}]%
     \else \@makechapterhead{#2}%
           \@afterheading          % Routine called after chapter and
     \fi}                          % section heading.
%
% Теперь подправим подписи к рисункам и таблицам
%
\message{captions,}
\long\def\@makecaption#1#2{%
  \vskip 10\p@
  \setbox\@tempboxa\hbox{#1. #2}% Заменили двоеточие на точку...
  \ifdim \wd\@tempboxa >\hsize
      \unhbox\@tempboxa\par
    \else
      \centerline{\box\@tempboxa}\fi}
\long\def\@caption#1[#2]#3{\par\addcontentsline{\csname
  ext@#1\endcsname}{#1}{\protect\numberline{\csname
  the#1\endcsname.}{\ignorespaces #2}}\begingroup
    \@parboxrestore
    \normalsize
    \@makecaption{\csname fnum@#1\endcsname}{\ignorespaces #3}\par
  \endgroup}

% Поправим колонтитулы (та же точка после номера).

\message{running heads,}

\if A\@mainstyle % стиль - article (вставлено ".\@aftersepkern" после номера)
  \if@twoside
  \def\ps@headings{\let\@mkboth\markboth
    \def\@oddfoot{}\def\@evenfoot{}%       No feet.
    \def\@evenhead{\hfil\leftmark\hfil}%        Left heading.
    \def\@oddhead{\hfil\rightmark\hfil}                                      % Right heading.
    \def\sectionmark##1{\markboth {\uppercase{\ifnum \c@secnumdepth >\z@
      \thesection\postsection \hskip 1em\relax \fi ##1}}{}}%
    \def\subsectionmark##1{\markright {\ifnum \c@secnumdepth >\@ne
          \thesubsection\postsubsection \hskip 1em\relax \fi ##1}}}
  \else
   \def\ps@headings{\let\@mkboth\markboth
    %\def\@oddfoot{}\def\@evenfoot{}%     No feet.
    %\def\@oddhead{{\sl \rightmark}\hfil \rm\thepage}% Heading.
    \def\sectionmark##1{\markright {\uppercase{\ifnum \c@secnumdepth >\z@
      \thesection\postsection \hskip 1em\relax \fi ##1}}}}
  \fi
\else\if R\@mainstyle % стиль=report. Два пробела после точки заменены на один.
  \if@twoside
  \def\ps@headings{\let\@mkboth\markboth
   \def\@oddfoot{}\def\@evenfoot{}%       No feet.
   \def\@evenhead{\rm \thepage\hfil \sl \leftmark}%        Left heading.
   \def\@oddhead{{\sl \rightmark}\hfil \rm\thepage}% Right heading.
   \def\chaptermark##1{\markboth {\uppercase{\ifnum \c@secnumdepth >\m@ne
       \@chapapp\ \thechapter. \fi ##1}}{}}%
   \def\sectionmark##1{\markright {\uppercase{\ifnum \c@secnumdepth >\z@
     \thesection. \fi ##1}}}}
  \else
  \def\ps@headings{\let\@mkboth\markboth
  \def\@oddfoot{}\def\@evenfoot{}%     No feet.
  \def\@oddhead{{\sl \rightmark}\hfil \rm\thepage}% Heading.
 \def\chaptermark##1{\markright {\uppercase{\ifnum \c@secnumdepth >\m@ne
   \@chapapp\ \thechapter. \fi ##1}}}}
  \fi
\else % стиль=book (два пробела после точки заменены на один)
\def\ps@headings{\let\@mkboth\markboth
 \def\@oddfoot{}\def\@evenfoot{}%       No feet.
 \def\@evenhead{\rm \thepage\hfil \sl \leftmark}%        Left heading.
 \def\@oddhead{{\sl \rightmark}\hfil \rm\thepage}% Right heading.
 \def\chaptermark##1{\markboth {\uppercase{\ifnum \c@secnumdepth >\m@ne
      \@chapapp\ \thechapter. \fi ##1}}{}}%
 \def\sectionmark##1{\markright {\uppercase{\ifnum \c@secnumdepth >\z@
   \thesection. \fi ##1}}}}
\fi\fi

%
% Подправим команду \appendix : нумерация русскими буквами,
% а не латинскими.
\message{appendix,}
\if A\@mainstyle
\def\appendix{\par
  \setcounter{section}{0}%
  \setcounter{subsection}{0}%
  \def\thesection{\Ralph{section}}}
\else
\def\appendix{\par
  \setcounter{chapter}{0}%
  \setcounter{section}{0}%
  \def\@chapapp{\appendixname}%
  \def\thechapter{\Ralph{chapter}}}
\fi

% Подправим еще одну feature: \cleardoublepage выдает на
% пустой странице колонтитул, оставшийся от предыдущего раздела.
% Сделаем так, чтобы этого не было...

\message{\string\output,}
\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else
   {\null\ps@empty % добавил \ps@empty (и заодно заменил \hbox{} на \null )
\newpage}\if@twocolumn\hbox{}\newpage\fi\fi\fi}

%
% Подправим \enddocument: будем подсчитывать общее количество
% страниц и выдавать сообщение "labels may have changed" по-русски
%
\message{\string\enddocument,}
\let\@refswarning\relax
\let\@@global\global
\@definecounter{totalpages}
\c@totalpages\m@ne
\newif\if@pagecntsw % true, если надо подсчитывать количество страниц
\def\countpages{\global\@pagecntswtrue}
\def\dontcountpages{\global\@pagecntswfalse}
\dontcountpages
\def\enddocument{\@checkend{document}\clearpage
\begingroup
 \if@filesw
   \advance\c@page\m@ne % \c@page==(total number of pages)
   \immediate\write\@mainaux
   {\string\@@global\string\c@totalpages\number\c@page\relax}%
 \fi
 \if@filesw \immediate\closeout\@mainaux
   \def\global\@namedef##1##2{}\def\newlabel{\@testdef r}%
   \def\@@global\c@totalpages##1\relax{%
     \@tempcnta\z@
     \if@pagecntsw
       \ifnum
         \c@totalpages=##1\else\@tempcnta\@ne
       \fi
     \fi
   }% end of \def\@@global
   \def\bibcite{\@testdef b}\@tempswafalse
    \if@tempswa
      \@refswarning
      \else
       \ifodd\@tempcnta\@refswarning\fi
    \fi
 \fi
\endgroup\deadcycles\z@\@@end}
%
% Теперь подкорректируем размеры страницы по высоте
% (в соответствии с рекомендациями А.Шеня)
%


\message{page size,}
\def\@margcorrx{-30}\def\@heightcorrx{60}% для 10 пунктов
\def\@margcorrxi{-34}\def\@heightcorrxi{68}% для 11 пунктов
\def\@margcorrxii{-30}\def\@heightcorrxii{60}% для 12 пунктов
\@tempcnta\@ptsize\advance\@tempcnta10%
%    Значение \@tempcnta равно кеглю
\advance\topmargin\@nameuse{@margcorr\romannumeral\@tempcnta}\p@
\advance\textheight\@nameuse{@heightcorr\romannumeral\@tempcnta}\p@

%
%
% Определим команды \ralph и \Ralph, аналогичные \alph и \Alph,
% но с русскими буквами. Естественно, \"е, й, ъ, ы, ь пропускаются.
\message{counters,}
\def\prefix#1#2{\@ifundefined{c@#1}{\@nocnterr}%
{\expandafter\def\csname p@#1\endcsname{#2}}}
\def\ralph#1{\@ralph{\@nameuse {c@#1}}}
\def\@ralph#1{\ifcase #1\or а\or б\or в\or г\or д\or е\or ж\or з\or
и\else\@iralph{#1}\fi
}
\def\@iralph#1{\ifcase #1\or\or\or\or\or\or\or\or\or\or
     к\or л\or м\or н\or о\or п\or р\or с\or т\or у\or
     ф\or х\or ц\or ч\or ш\or щ\or э\or ю \or я\else\@ctrerr
     \fi}
\def\Ralph#1{\@Ralph{\@nameuse {c@#1}}}
\def\@Ralph#1{\ifcase #1%
     \or А\or Б\or В\or Г\or Д\or Е\or Ж\or З\or
     И\else\@iRalph{#1}\fi}
\def\@iRalph#1{\ifcase #1%
     \or\or\or\or\or\or\or\or\or\or К\or Л\or М\or
     Н\or О\or П\or Р\or С\or Т\or У\or Ф\or Х\or Ц\or
     Ч\or Ш\or Щ\or Э\or Ю \or Я\else\@ctrerr
     \fi}
\message{lists,}
% Теперь "русифицируем" окружение enumerate:
\def\labelenumi{\theenumi)}      % чтобы после номера шла скобка;
\def\theenumii{\ralph{enumii}}   % чтобы на втором уровне шли русские,
\def\labelenumii{\theenumii)}    % а не латинские буквы
\def\p@enumii{\theenumi}         % а это для \ref
\def\labelenumiii{{\bf--}}       % а на третьем уровне пусть будут лишь тире,
\let\theenumiii\relax            % и отдельных ссылок на него не будет
\def\p@enumiii{\theenumi\theenumii}
%
%

\expandafter\ifx\csname No\endcsname\relax\chardef\No=194 \fi
\message{...finished.}

\def\m@th{\mathsurround=\z@}
\def\mathhexbox#1#2#3{\leavevmode
          \hbox{$\m@th\mathchar"#1#2#3$}}
\def\S{\mathhexbox278}

\voffset    7mm               %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%размеры страниц
\textwidth 156mm
\textheight 230mm
\oddsidemargin=-5mm
\evensidemargin=-1mm
%\hoffset=-1cm
%\topmargin -0.4cm


\pagestyle{myheadings}
\renewcommand{\@oddhead}{\hbox to 156mm{\hrulefill\raisebox{2.2mm}{\underline{\strut{\leftmark}}}\hrulefill\raisebox{2.2mm}{\underline{\strut{\thepage}}}}}
\renewcommand{\@evenhead}{\hbox to 156mm{\raisebox{2.2mm}{\underline{\strut{\thepage}}}\hrulefill\raisebox{2.2mm}{\underline{\strut{\rightmark}}}\hrulefill}}
%

\renewcommand{\@biblabel}[1]{#1.}

\newsavebox{\pagebox}
\def\m@th{\mathsurround=\z@}
\def\mathhexbox#1#2#3{\leavevmode
\hbox{$\m@th\mathchar"#1#2#3$}}
\def\S{\mathhexbox278}

\newtheorem{thm}{\hskip\parindent\textbf{Теорема}}               %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newtheorem*{thm*}{\hskip\parindent\textbf{Теорема}}               %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newtheorem{lem}{\hskip\parindent\textbf{Лемма}}                 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\let\tit\textit
\let\tsc\textsc
\let\tbf\textbf
\let\trm\textup
\let\ttt\texttt
\let\tup\textup


\newsavebox{\supportedby}
\newsavebox{\submitted}
\newsavebox{\udk}
\newsavebox{\ams}
\newsavebox{\AUTHOR}
\newsavebox{\TITLE}
\newsavebox{\EMAIL}
\newsavebox{\SummarY}

\newcommand{\keywords}[1]{Key words: \textit{#1}}
\renewcommand{\thefootnote}{$\star$}
\newcommand{\UDC}[1]{\sbox{\udk}{\textup{УДК\quad #1}}}
\newcommand{\AMS}[1]{\sbox{\ams}{\textup{MSC2010\quad #1}}}
\newcommand{\Submitted}[1]{\sbox{\submitted}{\hbox{\parbox[t]{7.5cm}{
Представлено в Дальневосточный математический журнал
#1}}}}
\newcommand{\SupportedBy}[1]{\sbox{\supportedby}{\hbox{\parbox[t]{7.5cm}{#1}}}}

\long\def\Author#1#2#3{\sbox{\AUTHOR}{\parbox{\textwidth}{%
\begin{center}
\copyright~{#1}${}^{1}$
\end{center}}}
\sbox{\EMAIL}{\parbox[t]{15cm}{\footnotesize #2. Электронная почта: \texttt{#3}}}
}



\markboth{\underline{\strut{\textsl{Дальневосточный математический журнал.} 2015. Том~15. \No~2. C.~\copy\pagebox}}}%%%%%%теперь меняем здесь
{\underline{\strut{\textsl{Дальневосточный математический журнал.} 2015. Том~15. \No~2. C.~\copy\pagebox}}}

\newcommand{\Abstract}[1]{\begin{quote}\tolerance=380 \normalsize #1\end{quote}}
\newcommand{\Summary}[3]{\sbox{\SummarY}{\language=0
\parbox{13cm}{{\it #1} \rm #2.
%
Far Eastern Mathematical Journal. 2015. V.~15. \No~2. P.~\copy\pagebox.\medskip   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%

\hfill{ABSTRACT}\hfill
\medskip

#3}
}}
\newcommand{\Title}[1]{\sbox{\TITLE}{\parbox{156mm}{
\begin{center}\LARGE\bf #1\end{center}}}}
\newcommand{\EndArticle}{\vskip1cm
\noindent\copy\submitted\hfill\copy\supportedby\\[.6cm]
\centerline{\vbox{\hrule width 13cm height.3pt}}
\vskip.5cm

%\noindent

\hfil\usebox{\SummarY}\hfil }



\DeclareMathOperator{\R}{\mathbb R}

\long\def\makeface{
\clearpage\@rpage=0
\medskip
\par\noindent
\usebox{\udk}
\par\noindent
\usebox{\ams}
\vskip 1cm
\begin{center} {\copy\AUTHOR}~\\
\copy\TITLE%\usebox{\TITLE}
\end{center}
\footnotetext[1]{\copy\EMAIL }
}
\thispagestyle{headings}
\DeclareMathOperator{\const}{const}
\endinput
