\documentclass[10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage[T2A]{fontenc}
\usepackage{graphics}
\usepackage{graphicx}
\usepackage{amsmath,amssymb,amsthm,amsfonts,amscd}
\usepackage{float}
\usepackage{xcolor}
\usepackage{subfig}
\usepackage{bm}
\usepackage{epstopdf}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{hyperref}
\captionsetup[algorithm]{labelformat=empty}

\newtheorem{thm}{\indent Теорема}
\newtheorem{lem}{\indent Лемма}
\newtheorem{prop}{\indent Утверждение}
\bibliographystyle{unsrt}
\graphicspath{{../optimization/results/}}
\usepackage[framemethod=default]{mdframed}

\newtheorem*{remark}{Замечание}


\begin{document}
    Build by \today
    \section{Введение}\label{sec:intro}
    Стационарная нормализированная диффузионная модель, описывающая радиационный и кондуктивный
    обмен в ограниченной области $\Omega \subset \mathbb{R}^3$ имеет следующий вид~\cite{modest-rht}
    \begin{equation}
        \label{initial}
        \begin{aligned}
            - a \Delta \theta + b \kappa_a(\theta ^ 3 | \theta | - \varphi) = 0,  \\
            - \alpha \Delta \varphi + \kappa_a (\varphi - \theta ^3 | \theta |) = 0.
        \end{aligned}
    \end{equation}
    Здесь $\theta$ – нормализованная температура,
    $\varphi$ – нормализованная интенсивность излучения, усредненная по всем направлениям.
    Положительные физические параметры $a, b, \kappa_a $ и $\alpha$,
    отвечающие свойствам среды, описываются следующим образом:
    \[
        a = \frac{k}{\rho c_v}, \; b = \frac{4 \sigma n^2 T^3_{\text{max}}}{\rho c_v}, \;
        \alpha = \frac{1}{3\kappa -A \kappa_s}
    \]
    где $k$ -- теплопроводность, $c_v$ -- удельная теплоёмкость, $\rho$ -- плотность,
    $\sigma$ -- постоянная Стефана\,--\,Больцмана, $n$ -- индекс рефракции,
    $T_{\text{max}}$ -- максимальная температура, $\kappa := \kappa_s + \kappa_a$ -- коэффициент
    полного взаимодействия, $\kappa_s$ -- коэффициент рассеяния.
    Коэффициент $A \in [-1,1]$ описывает анизотропию рассеивания;
    случай $A=0$ отвечает изотропному рассеиванию.

    Далее будем считать, что функция $\theta$ удовлетворяет следующему условию на границе
    $\Gamma = \partial \Omega$:
    \begin{equation}
        \label{theta-dirichlet}
        \theta|_\Gamma = \theta_b.
    \end{equation}
    Для задания сдандартного краевого условия для интенсивности излучения $\varphi$ обычно
    используют граничное условие вида
    \begin{equation}
        \label{phi-default}
        - \alpha \partial_n \varphi + \gamma (\varphi - \theta ^4) = 0.
    \end{equation}
    Здесь и далее $\partial_n$ обозначает производную в отношении внешней нормали.
    В случае если функция $\gamma$ не известна, естественно вместо краевого условия для
    интенсивности излучения задать значение теплового потока на границе
    \begin{equation}
        \label{theta-neumann}
        \partial_n \theta = q_b.
    \end{equation}
    Численное решение
    задачи~\eqref{initial},~\eqref{theta-dirichlet},~\eqref{theta-neumann},
    на которую мы будем ссылаться как на задачу $P$, является затруднительным из-за необходимости
    решать дифференциальное нелинейное уравнение четвёртого порядка.
    Теоретический анализ и доказательство существования решения задачи $P$ представлено
    в~\cite{cheb-same}.
    Одним из подходов к решению может быть замена исходной задачи $P$ на задачу
    оптимального управления.
    За функцию управления возьмём функцию $u$ такую, что
    \begin{equation}
        \label{phi-boundary}
        \alpha (\partial_n \varphi + \varphi) = u \;\; \text{на } \Gamma.
    \end{equation}
    Из граничных условий ~\eqref{theta-neumann},~\eqref{theta-dirichlet} получим
    \begin{equation}
        \label{theta-boundary}
        a (\partial_n \theta  + \theta)  = r \; \text{на } \Gamma, \; r := a \left(q_b + \theta_b\right).
    \end{equation}
    Задача оптимального управления заключается в минимизации функционала качества
    \begin{equation}
        \label{quality}
        J_\varepsilon(\theta, u) = \frac{1}{2} ||\theta - \theta_b||^2_\Gamma + \frac{\varepsilon}{2}||u||^2_\Gamma,
    \end{equation}
    Обозначим~\eqref{initial},~\eqref{phi-neumann},~\eqref{theta-neumann-r},~\eqref{quality}
    как задачу оптимального управления $CP$.


    Исследование ...
    %    математических моделей радиационного теплопереноса [1], учитывающих одновременно
    %    вклад эффектов теплопроводности и излучения даёт теоре-тическую основу для инженерных решений
    %    в различных областях, таких как произ-водство стекла [2],
    %    лазерная интерстициальная термотерапия [3], и др.
    %    Главной особенностью данных процессов является существенное влияние излучения на теплообмен
    %    при высоких температурах.
    %    Значительное число работ посвящено исследованиюзадач управления для
    %    нестационарных моделей сложного теплообмена [4–6], в ко-торых для описания температурного поля
    %    используется нестационарное уравнениетеплопроводности, а для моделирования излучения --
    %    стационарное диффузионноеприближение уравнения переноса излучения.
    %    В работах [7, 8] задача оптимального управления сводится к
    %    bang-bang принципу [9], или аналогичному.
    %    Близкая к рассмотренной в данной статье задача управления коэффициентом отражения
    %    для полностью стационарной модели исследовалась в [10],
    %    для нестационарной модели – в [11].
    %    Отметим также работы [12, 13], в которых рассмотрены свойства квазирешений
    %    обратных задач для уравнений тепломассапереноса.

    \section{Постановка задачи управления}\label{sec:formalization}
    Пусть $H = L^2(\Omega), V = H^1(\Omega), U = L^2(\Gamma)$, $V \subset H = H' \subset V'$
    Пространство $H$ отождествляем с сопряжённым пространством $H'$ так,
    что $V \subset H = H' \subset V'$.
    Определим $(f,v)$ как значение функционала $f \in V'$ на элементе $v \in V$,
    совпадающее со скалярным произведением в $H$, если $f\in H, \|f\|_\Gamma^2 = \int_\Gamma w^2$.
    Пространство $U = L^2(\Gamma)$ является пространством управлений;


    Пусть $v$ произвольный элемент множества $H^1(\Omega)$.
    Определим операторы:

    \begin{gather*}
        A \colon V \to V', \; B \colon U \to V', \; f \in V', \; g \in V'.\\
        (A y,z) = (\nabla y, \nabla v) + \int_\Gamma y v; \;
        (B w, v) = \int_\Gamma w z; \; f := Br
    \end{gather*}

    задача оптимального управления в операторном виде записывается в следующем виде.
    Найти тройку $\{u, \theta, \varphi \} \in U \times V \times V$:
    \begin{equation}
        \label{weak-theta}
        a A \theta + b \kappa_a (| \theta | \theta^3 - \varphi ) = f,
    \end{equation}
    \begin{equation}
        \label{weak-phi}
        \alpha A \varphi + \kappa_a (\varphi - |\theta|\theta^3)  = Bu.
    \end{equation}

    Задача нахождения оптимального управления состоит в минимизации функционала $J(\theta, u)$,
    определённом на паре $\theta, u$, где $\theta$ -- компонент
    решения системы~\eqref{weak-theta},\eqref{weak-phi}.
    Таким образом
    \begin{equation}
        \label{minimization}
        J_\varepsilon(\theta, u) = \frac{1}{2}\|\theta -\theta_b\|^2_\Gamma
        + \frac{\varepsilon}{2}\|u\|^2_\Gamma \rightarrow \text{inf}.
    \end{equation}

    Непустота множества допустимых троек следует из следующей леммы
    \begin{lem}
        \label{lemma-1}
        Пусть $r, u \in U$.
        Тогда сущесвует единственное решение~\eqref{weak-theta},\eqref{weak-phi} и справедливы оценки
        \begin{equation}
            \label{lemma-boundaries}
            \begin{aligned}
                a\|\theta\|_V \leq \|r\|_\Gamma + \frac{\kappa_a}{\alpha}\|r+bu\|_\Gamma, \\
                \alpha b \|\varphi\|_V \leq \|r\|_\Gamma +\left(\frac{\kappa_a}{\alpha} + 1\right).
            \end{aligned}
        \end{equation}
    \end{lem}
    \begin{proof}
        Умножим~\eqref{weak-phi} на $b > 0$ и сложим с~\eqref{weak-theta}
        \begin{gather*}
            A \left( a \theta + \alpha b \varphi \right) = B(r + bu),
            a\theta + \alpha b \varphi = a^{-1}B(r + bu),
            \varphi = \frac{1}{\alpha b}(A^{-1}B(r +bu) - a\theta).
        \end{gather*}
        Поэтому $\theta \in V$ является решением следующего уравнения:
        \begin{equation}
            \label{lemma-1-1}
            a A \theta + \frac{\kappa_a}{\alpha} \theta + b\kappa_a |\theta|\theta^3 = g.
        \end{equation}
        Здесь $g = Br + \frac{\kappa_a}{\alpha}A^{-1}B(r+bu) \in V'$.
        Однозначная разрешимость уравнения~\eqref{lemma-1-1} с монотонной нелинейностью
        известна~(???).

        Умножим скалярно~\eqref{lemma-1-1} на $\theta \in V$ и отбросим неотрицательные
        слагаемые в левой части
        $a \|\theta\|^2_V \leq (g, \theta) \leq \|g\|_V; \|\theta\|_V$,
        т.е. $a\|\theta\|V \leq \|g\|_v$.

        \begin{remark}
            \begin{enumerate}
                \item Если $\|z\|^2 \leq \kappa_o\|z\|^2_v$
                $\forall z \in V => \|z\|_{V'} \leq \kappa_o \|z\|_V$
                \item $\forall h \in U \; \|Bh\|_{V'} \leq \|h\|_\Gamma$
                \item $\|A^{-1}g\|_V \leq \|g\|_{V'} \; \forall g \in V!$
            \end{enumerate}
        \end{remark}

        С учетом замечаний получаем
        \begin{gather*}
            \|g\|_{V'} \leq \|r\|_\Gamma + \frac{\kappa}{\alpha}\kappa_o \|r + bu\|_\Gamma, \\
            \|\varphi\|_V \leq \frac{1}{\alpha b} \|r + bu\|_\Gamma + \frac{a}{\alpha b} \|\theta\|_V
        \end{gather*}
        откуда следуют оценки~\eqref{lemma-boundaries}.
    \end{proof}

    \section{Разрешимость задачи управления и система оптимальности}\label{sec:solvability-control}
    \begin{thm}
        \label{cp-existing}
        Пусть $\theta_b, q_b \in L^2(\Gamma)$.
        Тогда существует решение
        задачи~\eqref{weak-theta},\eqref{weak-phi},\eqref{minimization}.
    \end{thm}
    \begin{proof}
        Пусть $j_\varepsilon = \inf J_\varepsilon$ на множестве допустимых управлений $u \in U$,
        удовлетворяющих~\eqref{weak-theta},\eqref{weak-phi}.

        Существует $u_m \in U, \theta_m \in V, J_\varepsilon(\theta_m, u_m)|_{m \rightarrow \infty}
        \rightarrow j_\varepsilon $

        \begin{gather}
            \label{theorem-1-operational}
            a A \theta_m +b \kappa_a(|\theta|\theta^3 - \varphi_m) = Br, \\
            \alpha A \varphi_m + \kappa_a (\varphi_m - |\theta|\theta^3) = B u_m.
        \end{gather}


        Из Леммы~\ref{lemma-1} следует, что
        \begin{gather*}
            \|\theta_m\|_V \leq C,
            \|\varphi\|_V \leq C,
            \|u_m\| \leq C.
        \end{gather*}
        Что, в свою очередь, даёт нам $\|\theta_m\|_{L^6(\Omega)} \leq C.$
        Здесь через $C$ обозначена постоянная, не зависящая от $m$.

        Тогда существует тройка
        \begin{gather*}
            \label{theorem-1-convergence}
            \{ \hat{u}, \hat{\theta}, \hat{\varphi} \} \in U \times V \times V,
            u_m \rightarrow \hat{u} \text{слабо в } U, \\
            \theta_m, \varphi_m \rightarrow \hat{\theta}, \hat{\varphi} \text{слабо в } V, \text{сильно в } L^4(\Omega)
        \end{gather*}

        Заметим, что $\forall v \in V$
        \begin{equation}
            \label{theorem-1-est}
            |( |\theta|\theta^3 - |\hat{\theta}|\hat{\theta}^3, v) \leq
            2 \int_\Omega |\theta_m - \hat{\theta}| (|\theta_m|^3 + |\hat{\theta}|^3)|v| \\
            \leq 2 \| \theta_m - \hat{\theta}\|_{L^4(\Omega)} \|v\|_{L^4(\Omega)}
            ( \| \theta_m \|^3_{L_6(\Omega)} + \| \hat{\theta} \|^3)
        \end{equation}

        условие~\eqref{theorem-1-convergence} и оценка~\eqref{theorem-1-est} позволяют перейти
        к пределу в~\eqref{theorem-1-operational}:
        \[
            a A \hat{\theta} + b \kappa_a (|\theta|\theta^3 - \hat{\varphi} = Br), \;
            \alpha A \hat{\varphi} + \kappa_a (\hat{\varphi} -|\theta|\theta^3) = B \hat{u}.
        \]
        и при этом $j_\varepsilon \leq J(\hat{\theta}, \hat{u}) \leq \lim J(\theta_m, u_m) =
        j_\varepsilon$.
        Это значит, что тройка $\{ \hat{u}, \hat{\theta}, \hat{\varphi} \}$ есть
        решение задачи~\eqref{weak-theta},\eqref{weak-phi},\eqref{minimization}.
    \end{proof}

    Для вывода системы оптимальности для задачи~\eqref{weak-theta}-\eqref{minimization}
    воспользуемся теоремой 1.5~\cite{???}

    Оператор ограничений $F(\theta, \varphi, u) : V \times V \times U \rightarrow V' \times V'$ имеет вид
    \[
        F(y, u) = { aA\theta + b \kappa_a (|\theta|\theta^3 - \varphi) - f,
        \alpha A \varphi + \kappa_a (\varphi -|\theta| \theta^3) - bu}.
    \]

    \begin{lem}
        Для любой пары $y \in V \times V, u \in U$ справедливо
        \[
            \bm{Im}F_y'(y, u) = V' \times V'.
        \]
    \end{lem}
    \begin{proof}
        Достаточно показать разрешимость задачи
        \begin{equation}
            \label{lem-2-1}
            aA \xi + b \kappa_a (4|\theta|^3 \xi - \eta) = f_1, ;\ \\
            \alpha A \eta + \kappa_a (\eta - 4 |\theta|^3 \xi) = f_2.
        \end{equation}
        Задачу~\eqref{lem-2-1} запишем в виде операторного уравнения в пространстве
        $V \times V = W$ со скалярным произведением $(w, v)_W = (w_1, v_1)_V + (w_2, v_2)_V$
        \begin{equation}
            \label{lem-2-2}
            z + Tz = g, \; \text{где } z = \{ \xi, \eta \} \in V \times V.
        \end{equation}
        Здесь
        \begin{gather*}
            (Tz, v)_W = \frac{b\kappa_a}{\alpha}(4|\theta|^3 \xi - \eta, v_1)
            + \frac{\kappa_a}{\alpha}(\eta - 4|\theta|^3\xi, v_2), \\
            \forall v = \{v_1, v_2\} \in W, \; (g,v)_W = (f_1,v_1) + (f_2, v_2)
        \end{gather*}

        Покажем далее компакность оператора $T$.
        \begin{gather*}
            (Tz,v)_W \leq 4 \left( \frac{b \kappa_a}{a}
            + \frac{\kappa}{\alpha} \right) \|\theta\|^3_{L^6} \|\xi\|_{L^4}
            (\|v_1\|_{L^4} + \|v_2\|_{L^4})  \\
            + \left( \frac{b \kappa_a}{a} + \frac{\kappa_a}{\alpha} \right) \|\eta\|_{L^2}
            (\| v_1 \|_{L^2} + \|v_2\|_{L^2}).
        \end{gather*}
        Учитывая непрерывность вложения $V \subset L^4(\Omega) \subset L^2(\Omega)$ получаем
        \[
            (Tz, v)_W \leq C \| v \|_W (\| \xi \|_{L^4(\Omega)} + \| \eta \|_{L^2(\Omega)}).
        \]
        Здесь $C > 0$ зависит только от
        $b, \kappa_a, a, \alpha, \Omega, \|\theta \|_{L^6(\Omega)}$.
        Следовательно, $\|Tz\|_W \leq C (\| \xi \|_{L^4(\Omega)} + \| \eta \|_{L^2(\Omega)})$.
        Отсюда, с учетом компактности вложений $V \subset L^4(\Omega), V \subset L^2(\Omega)$,
        следует компактность оператора $T$.
        Резрешимость фредгольмового уравнения~\eqref{lem-2-2} следует теперь из
        теоремы единственности.
        Пусть $f_1 = f_2 = 0$.
        Умножим второе уравнение~\eqref{lem-2-1} на $b$ и сложим с первым.
        Тогда
        \[
            A(a \xi + \alpha \eta ) = 0, \; a \xi + \alpha \eta = 0.
        \]
        Таким образом первое уравнение имеет вид
        \[
            aA\xi + b\kappa_a\left(4|\theta|^3 + \frac{a}{\alpha}\right) \xi = 0.
        \]
        Умножим скалярно на $\xi$ получим $(A\xi,\xi) = 0, \xi = 0, \eta = 0$.
        Лемма доказана.
    \end{proof}

    Лагранжиан задачи~\eqref{weak-theta}-\eqref{minimization} имеет вид
    \begin{equation}
        \label{lagrangian}
        \begin{aligned}
            L(\theta, \varphi, u, p_1, p_2) = J_\varepsilon(\theta, u)
            & + (aA\theta + b\kappa_a(|\theta|\theta^3 - \varphi) - f, p_1) \\
            & + (\alpha A \varphi + \kappa_a(\varphi - |\theta|\theta^3) - Bu, p_2)
        \end{aligned}
    \end{equation}
    Условия оптимальности [????] имеют вид
    ...

    Пусть $\{ \hat{u}, \hat{\theta}, \hat{\varphi} \}$ - решение
    задачи~\eqref{weak-theta}-\eqref{minimization}.
    Тогда $\forall v \in V, z \in U$:
    \begin{gather}
        \label{optimality}
            (\hat{\theta} -\theta_b, v)_{L^2(\Gamma)} + (aAv + 4 b\kappa_a |\theta|^3, p_1)
            - \kappa_a ( 4 |\hat{\theta}|^3v, p2) = 0, \\
            - b \kappa_a (v, p_1) = (\alpha A v + \kappa_a v, p_2) = 0, \\
            \varepsilon (\hat{u},z)_{L^2(\Gamma)} - (Bz, p_2) = 0.
    \end{gather}
    Из условий~\eqref{optimality} получаем следующий результат
    \begin{thm}
        Пусть $\{\hat{u}, \hat{\theta}, \hat{\varphi}\}$ - решение
        задачи~\eqref{weak-theta}-\eqref{minimization}.
        Тогда существует пара $\{p_1, p_2 \} \in W$
        такая, что
        \begin{gather}
            \label{thm-2-1}
            aA\hat{\theta} + b \kappa_a(|\hat{\theta}|^3 \hat{\theta} -\varphi) = Br, \\
            \alpha A \hat{\varphi} + \kappa_a(\hat{\varphi} - |\hat{\theta}|\hat{\theta}^3) = Bu, \\
            aAp_1 +4|\hat{\theta}|^3 \kappa_a(bp_1 - p_2) = B(\theta_b - \hat{\theta}), \\
            \alpha A p_2 + \kappa_a (p_2 - b p_1) = 0, \\
            \varepsilon \hat{u} = p_2.
        \end{gather}
    \end{thm}


    \section{Численные эксперименты}\label{sec:experiments}
    Согласно формуле~\eqref{thm-2-1} градиент функционала $\hat{J}(u)$ имеет вид
    \[ \hat{J}'(u)= \varepsilon u - p_2, \]
    где $p_2$ -- соответствующая переменная сопряжённой системы.

    Предлагаемый алгоритм решения выглядит следующим образом:
    \begin{algorithm}[H]
        \caption{Алгоритм градиентного спуска с проекцией}
        \begin{algorithmic}[1]
            \State Выбираем значение градиентного шага $\lambda$,
            \State Выбираем количество итераций $N$,
            \State Выбираем произвольное $u_0 \in U$,
            \For{$k \gets 0,1,2,\ldots,N$}:
            \State Для полученного $u_k$ расчитываем состояние
            \State Расчитываем значение функционала качества $J(\theta_k)$ из \eqref{quality}.
            \State Расчитываем сопряжённое состояние $p_k=\{p_{1k},p_{2k}\}$ из
            уравнений~\eqref{thm-2-1} где $ \hat{\theta} := \theta_k, \hat{u}=u_k$.
            \State Пересчитываем управление
            $u_{k+1} = P_{ad}\left[ u_k - \lambda (\varphi_k - \theta_b^4)p_{2k} \right]$.
            \EndFor
        \end{algorithmic}
    \end{algorithm}
    Приведём далее примеры расчётов.
    Положим область $\Omega = \{(x, y, z), 0 \leq x, y, z \leq 1\}$, $l = 1$ см.
    Будем далее считать, что $a = 0.006[\text{см}^2/\text{c}]$, $b=0.025[\text{см}/\text{с}]$,
    $\kappa=1[\text{см}^{-1}]$, $\kappa_s = 0$, $A = 0$, $\gamma = 0.3$.
    Указанные параметры соответствуют стеклу~\cite{grenkin_13}.

    При указанных параметрах для первого эксперимента выберем следующее начальное значение
    функции $u$ (рис.~\ref{control}\subref{fig1:exp1}):
    \begin{equation}
        \label{test_function_1}
        u(x)= 0.9,
    \end{equation}
    и для второго эксперимента (рис.~\ref{control}\subref{fig1:exp2}):
    \begin{equation}
        \label{test_function_2}
        u(x)=0.49x+0.01.
    \end{equation}

    Далее, применяя предложенный алгоритм решаем задачу оптимального управления $CP$.
    Эффективность алгоритма, а также значение $u_0$
    в первом и втором случаях иллюстрируются рис.~\ref{control}.
    На рис.~\ref{cost} показана динамика функционала качества по итерациям.

    %    \begin{figure}[H]
    %        \centering
    %        \subfloat[Первый эксперимент]
    %        {
    %        \label{fig1:exp1}
    %        \includegraphics[width=.49\linewidth]{targetcontrol}
    %        }
    %        \subfloat[Второй эксперимент]
    %        {
    %        \label{fig1:exp2}
    %        \includegraphics[width=.49\linewidth]{end_control_full}
    %        }
    %        \caption{Тестовая функция $u$, найденная функция $u_{end}.$}
    %        \label{control}
    %    \end{figure}
    %
    %    \begin{figure}[H]
    %        \centering
    %        \subfloat[Динамика функции $\hat{J}(u)$ по итерациям]
    %        {
    %        \label{fig2:exp1}
    %        \includegraphics[width=.51\linewidth]{../../results/quality.png}
    %        }
    %        \subfloat[Функция $(u - u_{end})^2$]
    %        {
    %        \label{fig2:exp2}
    %        \includegraphics[width=.51\linewidth]{../../results/diff_end_control.png}
    %        }
    %        \caption{}
    %        \label{cost}
    %    \end{figure}


    \bibliography{bibliography}

\end{document}

